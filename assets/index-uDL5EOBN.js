import{a as s,ar as X,ah as r}from"./index-C5Hw-WH9.js";import{X as $,F as w,O as z}from"./IdurarOs-DZCQDfqB.js";import{u as B}from"./useDebounce-D3qm_pF7.js";import{S as l,E as G}from"./index-D8iAfrlz.js";function P({entity:x,displayLabels:O,searchFields:b,outputValue:a="id",redirectLabel:E="Thêm mới",withRedirect:u=!1,urlToRedirect:j="/",value:t,onChange:n}){const f=w(),h={value:"redirectURL",label:`+ ${f(E)}`},[y,m]=s.useState([]),[C,v]=s.useState(void 0),c=s.useRef(!0),A=s.useRef(!1),[L,o]=s.useState(!1),[S,R]=s.useState(""),[d,T]=s.useState(""),U=X(),k=e=>{c.current=!1,n&&e&&n(e[a]||e),e==="redirectURL"&&u&&U(j)},[,q]=B(()=>{T(S)},500,[S]),D=async e=>await z.search({entity:x,options:e});let{onFetch:N,result:p,isSuccess:g,isLoading:F}=$();const I=e=>O.map(i=>e[i]).join(" ");s.useEffect(()=>{const i=D({q:d,fields:b});return N(i),()=>{q()}},[d]);const W=e=>{A.current=!0,o(!0),R(e)};return s.useEffect(()=>{g?m(p.pageItems):o(!1)},[g,p]),s.useEffect(()=>{t&&c.current&&(m([t]),v(t[a]||t),n(t[a]||t),c.current=!1)},[t]),r.jsxs(l,{loading:F,showSearch:!0,allowClear:!0,placeholder:f("Tìm kiếm"),defaultActiveFirstOption:!1,filterOption:!1,notFoundContent:L?"... Searching":r.jsx(G,{}),value:C,onSearch:W,onClear:()=>{o(!1)},onChange:k,style:{minWidth:"220px"},children:[y.map(e=>r.jsx(l.Option,{value:e[a]||e,children:I(e)},e[a]||e)),u&&r.jsx(l.Option,{value:h.value,children:h.label})]})}export{P as A};
