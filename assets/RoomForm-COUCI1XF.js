import{a as c,ah as e}from"./index-D6WBlErs.js";import{A as S}from"./index-BK4ZAzEK.js";import{s as F}from"./index-KrFx5yLV.js";import{O as R,W as v,Q as l,ab as t,a9 as y,B as C,V as D}from"./IdurarOs-DdOogxid.js";import{S as f}from"./index-sIeLcHRr.js";import{T as d}from"./index-CqtEaQU7.js";import{S as w}from"./index-OVKKj6yh.js";import{U as O,a as k,s as N}from"./UploadOutlined-RatKogut.js";import{P as A}from"./PlusOutlined-DbOdGD9A.js";const P=({entity:i,labelKey:n="label",valueKey:h="id",mode:p="default",defaultValue:u,onChange:g,style:x={}})=>{const[j,I]=c.useState([]);return c.useEffect(()=>{async function o(){try{const s=await R.list({entity:i});I((s==null?void 0:s.result.pageItems)||[])}catch(s){console.error("Failed to fetch options:",s)}}o()},[i]),e.jsx(f,{mode:p,defaultValue:u,style:{width:"100%",...x},onChange:g,children:j.map(o=>e.jsx(f.Option,{value:o[h],children:o[n]},`${F.generate()}`))})},{TextArea:b}=y;function z({current:i=null,form:n=null}){return e.jsx(M,{current:i,form:n})}function M({current:i=null,form:n=null}){const[h,p]=c.useState([]),[u,g]=c.useState([]),[x,j]=c.useState([]),I=s=>{if(n!=null){const r=s.uid,m=n.getFieldValue("deleteImageIds")||[];n.setFieldsValue({deleteImageIds:[...m,r]})}};c.useEffect(()=>{var s,r,m;if(i!=null){const L=((s=i.amenities)==null?void 0:s.map(a=>a.id))||[],T=((r=i.services)==null?void 0:r.map(a=>a.id))||[],V=((m=i.roomImages)==null?void 0:m.map(a=>({uid:a.id,name:a.filePath.split("/").pop(),url:a.filePath,thumbUrl:a.filePath})))||[];g(L),p(T),j(V),n.setFieldsValue({deleteImageIds:[]})}},[i,n]);const o=s=>(s.type==="image/jpeg"||s.type==="image/png"||N.error("Bạn chỉ có thể tải lên tệp JPG/PNG!"),s.size/1024/1024<5||N.error("Ảnh phải nhỏ hơn 5MB!"),!1);return e.jsxs(e.Fragment,{children:[e.jsxs(v,{gutter:[12,0],children:[e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"roomNumber",label:"Tên phòng",rules:[{required:!0,message:"Vui lòng nhập tên phòng"}],children:e.jsx(y,{})})}),e.jsx(l,{className:"gutter-row",span:8,children:e.jsx(t.Item,{name:"roomTypeId",label:"Loại phòng",rules:[{required:!0,message:"Vui lòng chọn loại phòng"}],children:e.jsx(S,{entity:"roomtype",displayLabels:["roomTypeName"],searchFields:"roomTypeName",redirectLabel:"Thêm loại phòng",withRedirect:!0,urlToRedirect:"/roomtype"})})}),e.jsx(l,{className:"gutter-row",span:6,children:e.jsx(t.Item,{label:"Trạng thái",name:"status",rules:[{required:!0}],initialValue:"Available",children:e.jsx(f,{options:[{value:"Available",label:"Có sẵn"},{value:"Locked",label:"Khóa"}]})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"numberOfPeople",label:"Số người tối đa",rules:[{required:!0,type:"number",message:"Vui lòng nhập số người"}],children:e.jsx(d,{min:1})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"originalPrice",label:"Giá gốc",min:0,rules:[{required:!0,message:"Vui lòng nhập giá gốc"}],children:e.jsx(d,{style:{width:"100%"},formatter:s=>`${s}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:s=>s.replace(/\./g,""),suffix:"VND",min:0})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"discountedPrice",label:"Giá giảm",children:e.jsx(d,{style:{width:"100%"},formatter:s=>`${s}`.replace(/\B(?=(\d{3})+(?!\d))/g,"."),parser:s=>s.replace(/\./g,""),min:0})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"priceDescription",label:"Mô tả giá",children:e.jsx(b,{rows:1})})}),e.jsx(l,{className:"gutter-row",span:24,children:e.jsx(t.Item,{name:"amenityIds",label:"Tiện ích",children:e.jsx(P,{defaultValue:u,entity:"amenity",labelKey:"amenityName",mode:"multiple",onChange:s=>console.log("Selected:",s)})})}),e.jsx(l,{className:"gutter-row",span:24,children:e.jsx(t.Item,{name:"serviceIds",label:"Dịch vụ",children:e.jsx(P,{defaultValue:h,entity:"service",labelKey:"serviceName",mode:"multiple",onChange:s=>console.log("Selected:",s)})})}),e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"roomDescription",label:"Mô tả phòng",children:e.jsx(b,{rows:2})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"isRefundable",label:"Hoàn tiền",valuePropName:"checked",children:e.jsx(w,{checkedChildren:"Có",unCheckedChildren:"Không"})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"isCancelable",label:"Hủy phòng",valuePropName:"checked",children:e.jsx(w,{checkedChildren:"Có",unCheckedChildren:"Không"})})}),e.jsx(l,{span:8,children:e.jsx(t.Item,{name:"cancellationDeadlineHours",label:"Giờ hết hạn hủy",children:e.jsx(d,{min:0})})}),e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"CancellationPolicyDescription",label:"Mô tả chính sách hủy bỏ",children:e.jsx(b,{rows:2})})}),e.jsx(l,{span:24,children:e.jsx(t.Item,{name:"files",label:"Ảnh",valuePropName:"imageList",getValueFromEvent:s=>s.fileList.map(r=>r.originFileObj),children:e.jsx(O,{beforeUpload:o,listType:"picture",accept:"image/png, image/jpeg",maxCount:10,multiple:!0,onRemove:I,defaultFileList:x,children:e.jsx(C,{icon:e.jsx(k,{}),children:"Chọn để tải ảnh"})})})}),e.jsx(t.Item,{name:"deleteImageIds",initialValue:[],children:e.jsx(y,{type:"hidden"})})]}),e.jsx(D,{dashed:!0}),e.jsx("div",{style:{position:"relative",width:" 100%",float:"right"},children:e.jsx(v,{gutter:[12,-5],children:e.jsx(l,{className:"gutter-row",span:5,children:e.jsx(t.Item,{children:e.jsx(C,{type:"primary",htmlType:"submit",icon:e.jsx(A,{}),block:!0,children:"Lưu"})})})})})]})}export{z as R};
